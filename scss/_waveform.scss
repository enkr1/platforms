// ============================================
// Waveform Visualization
// ============================================

.waveform {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 100px;
  pointer-events: none;
  z-index: 5;
  opacity: 0.4;
  transition: opacity 0.5s ease;

  // Hide when Spotify bar is expanded
  .spotify-bar.expanded ~ & {
    opacity: 0;
  }
}

.waveform-svg {
  width: 100%;
  height: 100%;
  overflow: visible;
}

.waveform-path {
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  transition: stroke 0.5s ease;
}

// Layer 1 - Back (slowest, largest amplitude)
.waveform-path-1 {
  stroke: var(--color-accent);
  opacity: 0.3;
  stroke-width: 3;
  animation: waveformAnimate1 8s ease-in-out infinite;
}

// Layer 2 - Middle
.waveform-path-2 {
  stroke: var(--color-work-primary);
  opacity: 0.5;
  stroke-width: 2;
  animation: waveformAnimate2 6s ease-in-out infinite;
}

// Layer 3 - Front (fastest, smallest amplitude)
.waveform-path-3 {
  stroke: var(--color-experience-primary);
  opacity: 0.7;
  stroke-width: 1.5;
  animation: waveformAnimate3 4s ease-in-out infinite;
}

// Mode-based waveform colors
[data-mode="work"] {
  .waveform-path-1 {
    stroke: var(--color-work-secondary);
  }
  .waveform-path-2 {
    stroke: var(--color-work-primary);
  }
  .waveform-path-3 {
    stroke: var(--color-work-accent);
  }
}

[data-mode="experience"] {
  .waveform-path-1 {
    stroke: var(--color-experience-secondary);
  }
  .waveform-path-2 {
    stroke: var(--color-experience-primary);
  }
  .waveform-path-3 {
    stroke: var(--color-experience-accent);
  }
}

// Waveform animations
// These will be overridden by JS for dynamic waves
// But provide fallback animation

@keyframes waveformAnimate1 {
  0%, 100% {
    d: path("M0,100 Q360,50 720,100 T1440,100 L1440,200 L0,200 Z");
  }
  50% {
    d: path("M0,100 Q360,150 720,100 T1440,100 L1440,200 L0,200 Z");
  }
}

@keyframes waveformAnimate2 {
  0%, 100% {
    d: path("M0,120 Q360,80 720,120 T1440,120 L1440,200 L0,200 Z");
  }
  50% {
    d: path("M0,120 Q360,160 720,120 T1440,120 L1440,200 L0,200 Z");
  }
}

@keyframes waveformAnimate3 {
  0%, 100% {
    d: path("M0,140 Q360,120 720,140 T1440,140 L1440,200 L0,200 Z");
  }
  50% {
    d: path("M0,140 Q360,160 720,140 T1440,140 L1440,200 L0,200 Z");
  }
}

// Heartbeat mode (when not playing music)
.waveform.heartbeat {
  .waveform-path {
    animation-timing-function: ease-in-out;
  }

  .waveform-path-2 {
    animation: heartbeatWave 1.5s ease-in-out infinite;
  }
}

@keyframes heartbeatWave {
  0%, 100% {
    d: path("M0,150 L400,150 Q450,150 500,150 Q550,100 600,150 Q650,200 700,150 Q750,150 800,150 L1440,150 L1440,200 L0,200 Z");
  }
  25% {
    d: path("M0,150 L400,150 Q450,150 500,150 Q550,80 600,150 Q650,220 700,150 Q750,150 800,150 L1440,150 L1440,200 L0,200 Z");
  }
  50% {
    d: path("M0,150 L400,150 Q450,150 500,150 Q550,120 600,150 Q650,180 700,150 Q750,150 800,150 L1440,150 L1440,200 L0,200 Z");
  }
}

// Reduced motion
@media (prefers-reduced-motion: reduce) {
  .waveform-path {
    animation: none !important;
  }
}
